<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ryan.mapper.DetailBookMapper">

<select id="searchEBook" resultType="com.ryan.domain.EBookVO">
	SELECT * FROM eBook WHERE book_num=#{bookNum}
</select>

<select id="searchReview" resultType="com.ryan.domain.ReviewVO">
	SELECT * FROM book_Review WHERE book_num=#{bookNum}
</select>

<select id="interestbooks" resultType="com.ryan.domain.EBookVO">
	<![CDATA[
	SELECT * FROM 
	(SELECT * FROM eBook WHERE category=#{category} ORDER BY DBMS_RANDOM.RANDOM) WHERE rownum <= 6 
	]]>
	
</select>

<select id="bookLike" resultType="com.ryan.domain.BookLikeVO">
	SELECT * FROM book_Like WHERE book_num=#{bookNum}
</select>

<select id="bookGrade" resultType="_double"> 
	<![CDATA[
		SELECT avg(grade_score) FROM book_Grade WHERE book_num=#{bookNum}
	]]>
</select>

<select id="hashtag" resultType="com.ryan.domain.HashtagVO">
	SELECT * FROM book_hashtag WHERE book_num=#{bookNum} ORDER BY hash_num DESC
</select>

<select id="likepeople" resultType="com.ryan.domain.MemberVO">
	<![CDATA[
		select * from member m, ebook e, book_like l 
		where m.member_id=l.member_id and l.book_num = e.book_num
		and l.member_id=#{memberId} order by l.like_num desc
	]]>
</select>

<insert id="insertHashtag" parameterType="com.ryan.domain.HashtagVO">
	INSERT INTO book_hashtag VALUES(#{bookNum}, #{hashTag})
</insert>

<insert id="insertGrade" parameterType="com.ryan.domain.BookGradeVO">
	INSERT INTO book_grade VALUES(#{memberId},#{bookNum},#{gradeScore})
</insert>




</mapper>